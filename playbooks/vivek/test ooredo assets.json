{
    "@context": "\/api\/3\/contexts\/Workflow",
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "test ooredo assets",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/33f0ab21-60d4-4f9b-8178-a795be8399db",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/b0d74327-168e-4013-a863-aea03ee4a4ac",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "logsData": "{% set v1 = vars.steps.Get_Alert[0].sourcedata| from_json%}\n{{v1['RuleBlocks'][0]['DrillDownLogs']}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "aade0ff3-596d-4a8e-8871-a199866a6754"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Host Details",
            "description": null,
            "arguments": {
                "originHost": "{{vars.logsData | json_query('[*][\"originHost\"][]') | unique}}",
                "userOrigin": "{{vars.logsData | json_query('[*][\"login\"][]') | unique}}",
                "commonEvent": "{{vars.logsData | json_query('[*][\"commonEventName\"][]') | unique}}",
                "impactedHost": "{{vars.logsData | json_query('[*][\"impactedHost\"][]') | unique}}",
                "classification": "{{vars.logsData | json_query('[*][\"classificationName\"][]') | unique}}"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "8690db3f-a745-4307-9aed-1695736887a8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Alert",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "id",
                            "value": 332,
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "alerts?$limit=30",
                "step_variables": []
            },
            "status": null,
            "top": "119",
            "left": "495",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "832e3fe2-5fde-4e89-94d6-8541a28e0d99"
        },
        {
            "@type": "WorkflowStep",
            "name": "Remove Duplicate Host Details",
            "description": null,
            "arguments": {
                "config": "b5195722-9917-4e6e-ac0f-cddab46620ee",
                "params": {
                    "python_function": "host_list = {{vars.originHost}}\nhost_metadata = {{vars.logsData}}\ndict1 = dict()\ndict2 = dict()\ndict3 = dict()\ndict4 = dict()\nreq_keys = [\"impactedHost\", \"commonEventName\", \"classificationName\", \"login\"]\nfor i in host_list:\n    dict1[i] = []\n    dict2[i] = []\n    dict3[i] = []\n    dict4[i] = []\n    for j in host_metadata:\n        if i == j[\"originHost\"]:\n            for x in req_keys:\n                if x not in j:\n                    j[x] = \"NA\"\n            dict1[i].append(j[\"impactedHost\"])\n            dict2[i].append(j[\"commonEventName\"])\n            dict3[i].append(j[\"classificationName\"])\n            dict4[i].append(j[\"login\"])\n\ntemp1 = dict1\ntemp2 = dict2\ntemp3 = dict3\ntemp4 = dict4\n\nfor x, y in dict1.items():\n    temp1[x] = list(set(y))\nfor x, y in dict2.items():\n    temp2[x] = list(set(y))\nfor x, y in dict3.items():\n    temp3[x] = list(set(y))\nfor x, y in dict4.items():\n    temp4[x] = list(set(y))\n\nresult = {\"impactedHost\": temp1, \"commonEvent\": temp2, \"classification\": temp3, \"userOrigin\": temp4}\nprint(result)"
                },
                "version": "2.0.3",
                "connector": "code-snippet",
                "operation": "python_inline_code_editor",
                "operationTitle": "Execute Python Code",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/1fdd14cc-d6b4-4335-a3af-ab49c8ed2fd8",
            "group": null,
            "uuid": "f77c6fe1-7f66-4ffd-867f-019fc3983803"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "82e3d3cd-51b4-4548-ae46-1eb2fc5e1c84",
                "resources": [
                    "alerts"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "triggerOnSource": true,
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "primitive",
                                "field": "id",
                                "value": "332",
                                "operator": "eq",
                                "_operator": "eq"
                            }
                        ]
                    },
                    "ooredoo_asset": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                    "visible": false,
                    "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "b0d74327-168e-4013-a863-aea03ee4a4ac"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Fetch Host Details",
            "targetStep": "\/api\/3\/workflow_steps\/8690db3f-a745-4307-9aed-1695736887a8",
            "sourceStep": "\/api\/3\/workflow_steps\/aade0ff3-596d-4a8e-8871-a199866a6754",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "cc027f9f-c415-42d9-9250-a92f8644c5b5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Host Details -> Remove Duplicate Host Details",
            "targetStep": "\/api\/3\/workflow_steps\/f77c6fe1-7f66-4ffd-867f-019fc3983803",
            "sourceStep": "\/api\/3\/workflow_steps\/8690db3f-a745-4307-9aed-1695736887a8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ca061448-2569-4c4d-aea1-dab274b92d45"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Alert -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/aade0ff3-596d-4a8e-8871-a199866a6754",
            "sourceStep": "\/api\/3\/workflow_steps\/832e3fe2-5fde-4e89-94d6-8541a28e0d99",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e0a8fa9d-13fa-4bca-9398-c67e46ec6f97"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get Alert",
            "targetStep": "\/api\/3\/workflow_steps\/832e3fe2-5fde-4e89-94d6-8541a28e0d99",
            "sourceStep": "\/api\/3\/workflow_steps\/b0d74327-168e-4013-a863-aea03ee4a4ac",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9fe87854-4ef5-4a02-90c9-e4feb094eca4"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "playbookOrigin": "\/api\/3\/picklists\/15c1e8c9-22bf-4e66-8fbb-0a502d4a4a3f",
    "isEditable": true,
    "uuid": "0fc0819a-6728-4f97-9d72-2c51870144d8",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": []
}