{
    "@context": "\/api\/3\/contexts\/Workflow",
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "bajaj",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/33f0ab21-60d4-4f9b-8178-a795be8399db",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/ba212227-e2c7-4de8-b8db-8d730b3ea69d",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Call ReferenceTest PB",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.Iplist}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "Ioc": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": true,
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/9bab8a4f-95c7-45f1-902b-fd360e2b5440"
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "93bc76e5-8992-46bd-810a-9c184d813c03"
        },
        {
            "@type": "WorkflowStep",
            "name": "Final List",
            "description": null,
            "arguments": {
                "updatelist": "{% set raw_string = vars.getlistofiocs %}\n{% set items = raw_string | replace(\"[\", \"\") | replace(\"]\", \"\") | split(\",\") %}\n{% set cleaned_list = items | map('trim') | reject('equalto', 'Undefined') | list %}\n{{ cleaned_list }}"
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "36d2aa00-46bb-4ca0-b193-61385f045aa8"
        },
        {
            "@type": "WorkflowStep",
            "name": "get list of iocs",
            "description": null,
            "arguments": {
                "getlistofIocs": "{% set var1 = [] %}\n{% for i in vars.steps.Call_ReferenceTest_PB %}\n  {% if 'failedioc' in i %}\n    {% do var1.append(i['failedioc']) %}\n  {% endif %}\n{% endfor %}\n{{ var1 }}"
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "794cd2ac-626d-40b5-9b21-a1f754d4d268"
        },
        {
            "@type": "WorkflowStep",
            "name": "get list of variables",
            "description": null,
            "arguments": {
                "temp": "{% set list1 = [] %}\n{% for item in vars.getlistofIocs %}\n  {% do list1.append(item) %}\n{% endfor %}\n{{ list1|string }}"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "dedfde70-7a64-4b25-a5a4-ad6618b8b94f"
        },
        {
            "@type": "WorkflowStep",
            "name": "List Of Iocs",
            "description": null,
            "arguments": {
                "Iplist": "{% set ip_list = [\n    '199d11d0fd7043fe9206954ed8bc7b54d1912013a2a71bdf8bb007b71bb490c8','1.1.1.1' ] %}\n{{ip_list}}"
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "c3eaf748-670c-4f34-b02d-9ec49d71c13e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "abb1dc3b-0923-4a22-a9c6-912d60c44c3f",
                "resources": [
                    "alerts"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    },
                    "useMockOutput": "true"
                },
                "triggerOnSource": true,
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                    "visible": false,
                    "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "ba212227-e2c7-4de8-b8db-8d730b3ea69d"
        },
        {
            "@type": "WorkflowStep",
            "name": "update global varible",
            "description": null,
            "arguments": {
                "params": {
                    "macro": "Testbajaj",
                    "value": "{{vars.getlistofIocs}}"
                },
                "version": "3.4.0",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create\/Update Global Variables",
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "825",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "17b73f99-5e16-4b89-b85b-6dcc74dfdcff"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Call ReferenceTest PB -> get list of iocs",
            "targetStep": "\/api\/3\/workflow_steps\/794cd2ac-626d-40b5-9b21-a1f754d4d268",
            "sourceStep": "\/api\/3\/workflow_steps\/93bc76e5-8992-46bd-810a-9c184d813c03",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a1ce0863-504c-49b4-af81-212036321e8f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "get list of iocs -> get list of variables",
            "targetStep": "\/api\/3\/workflow_steps\/dedfde70-7a64-4b25-a5a4-ad6618b8b94f",
            "sourceStep": "\/api\/3\/workflow_steps\/794cd2ac-626d-40b5-9b21-a1f754d4d268",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "02e6b4ae-13dd-4eab-9115-eccd216915f7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "List Of Ips -> Call ReferenceTest PB",
            "targetStep": "\/api\/3\/workflow_steps\/93bc76e5-8992-46bd-810a-9c184d813c03",
            "sourceStep": "\/api\/3\/workflow_steps\/c3eaf748-670c-4f34-b02d-9ec49d71c13e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "cf4e375d-6b5c-409f-8fc1-5b25639ae888"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> List Of Ips",
            "targetStep": "\/api\/3\/workflow_steps\/c3eaf748-670c-4f34-b02d-9ec49d71c13e",
            "sourceStep": "\/api\/3\/workflow_steps\/ba212227-e2c7-4de8-b8db-8d730b3ea69d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "aee265fa-4164-4652-b722-02f4a6f19475"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "playbookOrigin": "\/api\/3\/picklists\/15c1e8c9-22bf-4e66-8fbb-0a502d4a4a3f",
    "isEditable": true,
    "uuid": "32af0240-db70-4503-a4b0-2051572a211d",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": []
}